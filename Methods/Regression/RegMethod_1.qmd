
Here we are working on a basic multiple linear model with cross validation. 

Importing data
```{r}
library(tidyverse); theme_set(theme_bw())
reg_data_long <- read_csv(".\\..\\..\\Data\\reg_data_long.csv")
head(reg_data_long)
reg_data_long$female_prop <- reg_data_long$FemalePop/reg_data_long$TotalPop

```

Question: Can mortality rate from heart disease per 1000 people be predicted from demographic conditions (such as healthcare funding or median income) within counties in California?

To start, we will employ a series of multiple regressions to get a better understanding of the relationships at play and which variables are most useful in predicting the mortality rate from heart disease. 

Splitting up the data
```{r}
set.seed(123)

training_pct <- .8
Z <- sample(nrow(reg_data_long), floor(training_pct*nrow(reg_data_long)))

train <- reg_data_long[Z,]
dim(train)
test <- reg_data_long[-Z,]
dim(test)

test$County <- factor(test$County, levels = levels(train$County))


```
Look at Correlations ...
```{r}
names(train)
```

Training the full model
```{r}
full_model <- lm(DeathsperThou ~ TotalPop + MalePop + FemalePop + MedianAge + MaleMedianAge + FemaleMedianAge + Under5yoPop + Under18yoPop + Pop21andOlder + Pop55andOlder + Pop60andOlder + Pop65andOlder + PercFemale +PercUnder18yo + num_desig + amer_indian + black + hispanic + asian + multi_race + pac_island + white + poverty + labor_force + unemployed + median_income + TotalDeaths + TotalCases + prop_hpsa + nonwhite_prop + Rating + Deaths + unempl_prop + poverty_prop + prop55older + Cases + HospNumber + CasesperThou + female_prop , family = "binomial", data = train)
summary(full_model)
plot(full_model)
```

Testing the full model
```{r}
prediction <- predict(full_model, newdata = test)
```

Error rate
```{r}
library(caret)
RMSE(predict, test$DeathsperThou)

```

Training the reduced model
```{r}
reduced_model <- lm(DeathsperThou ~ black + Deaths + Cases + CasesperThou, family = "binomial", data = train)
summary(reduced_model)
plot(reduced_model)
```

Testing the reduced model
```{r}
prediction_reduced <- predict(reduced_model, newdata = test)

```

Error rate
```{r}

```

Comparison between the two models and reccomednation 

